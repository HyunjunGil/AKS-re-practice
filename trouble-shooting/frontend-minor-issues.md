# 프론트엔드 이슈 해결 및 개선 과정 기록

## 1. 페이지네이션 미적용 문제

### 문제 상황
프론트엔드에서 메시지 목록, Redis 로그, Kafka 로그를 조회할 때 페이지네이션이 적용되지 않아 모든 데이터가 한 번에 로드되어 성능 저하와 사용자 경험 악화가 발생

### 예상했던 원인
백엔드에서 페이지네이션을 지원하지 않거나, 프론트엔드에서 페이지네이션 UI가 구현되지 않았을 것으로 예상

### 실제 원인 및 해결 방법
백엔드와 프론트엔드 모두에서 페이지네이션이 구현되지 않음. 다음과 같이 해결:

1. **백엔드 페이지네이션 구현**:
   - `/db/messages` API에 `offset`, `limit` 파라미터 추가
   - `/logs/redis` API에 페이지네이션 적용
   - `/logs/kafka` API에 페이지네이션 적용
   - `has_more`, `total_count` 등 페이지네이션 정보 반환

2. **프론트엔드 페이지네이션 UI 추가**:
   - "더 보기" 버튼과 페이지네이션 정보 표시
   - `loadMore()`, `loadMoreRedisLogs()`, `loadMoreKafkaLogs()` 메서드 구현
   - 페이지네이션 상태 관리 (`hasMore`, `offset`, `limit`)

3. **데이터 로딩 로직 개선**:
   - 기존 데이터에 새 데이터 추가 방식으로 변경
   - 페이지네이션 초기화 기능 추가

## 2. 시간 표시 정확도 문제

### 문제 상황
메시지와 로그의 타임스탬프에서 밀리초가 제대로 표시되지 않아 정확한 시간 정보를 제공하지 못함

### 예상했던 원인
`datetime.utcnow()` 사용으로 인해 마이크로초 정보가 누락되었거나, 시간 변환 과정에서 정밀도가 떨어졌을 것으로 예상

### 실제 원인 및 해결 방법
`datetime.utcnow()`는 마이크로초를 포함하지 않는 문제였음. 다음과 같이 해결:

1. **백엔드 시간 생성 수정**:
   - `datetime.utcnow()` → `datetime.now()`로 변경
   - `datetime.now().isoformat()`으로 마이크로초까지 포함

2. **프론트엔드 시간 표시 개선**:
   - 밀리초 부분 추출 및 표시 로직 추가
   - 한국 시간대 변환 로직 유지

## 3. 유저별 데이터 격리 문제

### 문제 상황
로그아웃하고 다른 유저로 로그인할 때 이전 유저의 데이터(메시지, Redis 로그, Kafka 로그)가 그대로 남아있어 보안상 문제가 발생

### 예상했던 원인
세션 변경 시 데이터 초기화 로직이 없거나, 백엔드에서 유저별 데이터 필터링이 제대로 되지 않았을 것으로 예상

### 실제 원인 및 해결 방법
프론트엔드와 백엔드 모두에서 유저별 데이터 격리가 제대로 구현되지 않음. 다음과 같이 해결:

1. **백엔드 유저별 데이터 필터링**:
   - Redis 로그 API에 `@login_required` 데코레이터 추가
   - 현재 유저의 로그만 필터링하여 반환
   - Kafka 로그 API에도 동일한 필터링 적용

2. **프론트엔드 데이터 초기화**:
   - `clearAllData()` 메서드로 모든 데이터 초기화
   - 로그인/로그아웃 시 자동 데이터 초기화
   - `loadUserData()` 메서드로 새 유저 데이터 로드

3. **세션 상태 관리**:
   - `/session/status` API로 현재 로그인 상태 확인
   - `mounted` 훅에서 자동 세션 상태 확인 및 데이터 로드

## 4. 페이지네이션 초기화 누락 문제

### 문제 상황
새 메시지를 저장하거나 샘플 데이터를 추가한 후 페이지네이션이 초기화되지 않아 데이터 중복이나 누락이 발생

### 예상했던 원인
데이터 변경 후 페이지네이션 상태를 리셋하지 않아서 발생한 문제로 예상

### 실제 원인 및 해결 방법
데이터 저장 후 페이지네이션을 초기화하지 않음. 다음과 같이 해결:

1. **페이지네이션 초기화 로직 추가**:
   - `getFromDb(true)`, `getRedisLogs(true)` 등에 `resetPagination` 파라미터 추가
   - 데이터 저장 후 페이지네이션 초기화하여 처음부터 다시 로드

2. **상태 관리 개선**:
   - `offset`, `hasMore` 등 페이지네이션 관련 상태 초기화
   - 새 데이터 로드 시 기존 데이터와 병합하지 않고 교체

## 5. 로그인/로그아웃 시 데이터 동기화 문제

### 문제 상황
로그인 상태 변경 시 프론트엔드의 데이터가 백엔드와 동기화되지 않아 일관성 문제가 발생

### 예상했던 원인
세션 변경 시 데이터 새로고침 로직이 없거나, 비동기 처리로 인한 타이밍 이슈가 있을 것으로 예상

### 실제 원인 및 해결 방법
로그인/로그아웃 시 데이터 동기화 로직이 부족함. 다음과 같이 해결:

1. **자동 데이터 동기화**:
   - 로그인 성공 후 `clearAllData()` → `loadUserData()` 순서로 실행
   - 로그아웃 후 `clearAllData()`로 모든 데이터 초기화

2. **비동기 처리 개선**:
   - `async/await`를 사용하여 데이터 로딩 순서 보장
   - 에러 처리 및 로딩 상태 관리

## 6. 페이지네이션 UI 스타일링 문제

### 문제 상황
페이지네이션 버튼과 정보 표시가 기본 스타일로만 되어 있어 사용자 경험이 좋지 않음

### 예상했던 원인
CSS 스타일링이 부족하거나 일관된 디자인 시스템이 적용되지 않았을 것으로 예상

### 실제 원인 및 해결 방법
페이지네이션 UI에 대한 스타일링이 누락됨. 다음과 같이 해결:

1. **페이지네이션 스타일 추가**:
   - `.load-more-btn` 클래스로 버튼 스타일링
   - `.pagination-info` 클래스로 정보 표시 스타일링
   - 호버 효과 및 비활성화 상태 스타일링

2. **일관된 디자인**:
   - 기존 버튼 스타일과 동일한 색상 및 크기 적용
   - 반응형 디자인 및 접근성 고려

## 7. 데이터 로딩 상태 표시 문제

### 문제 상황
페이지네이션으로 추가 데이터를 로드할 때 로딩 상태가 표시되지 않아 사용자가 작업 진행 상황을 알 수 없음

### 예상했던 원인
로딩 상태 관리 로직이 부족하거나 UI에 표시되지 않았을 것으로 예상

### 실제 원인 및 해결 방법
로딩 상태 관리가 제대로 구현되지 않음. 다음과 같이 해결:

1. **로딩 상태 관리**:
   - `loading`, `redisLogsLoading`, `kafkaLogsLoading` 변수 추가
   - 각 API 호출 시 로딩 상태 설정 및 해제

2. **UI 피드백 개선**:
   - "더 보기" 버튼에 로딩 중 텍스트 표시
   - 버튼 비활성화로 중복 클릭 방지
   - 로딩 완료 후 상태 복원

## 8. 최종 검증 및 테스트

### 문제 상황
모든 수정 사항이 제대로 작동하는지 확인이 필요

### 예상했던 원인
개별 수정 사항들이 서로 연동되어 전체 시스템이 정상 작동하는지 검증이 필요

### 실제 원인 및 해결 방법
단계별로 검증하고 최종 테스트를 진행:

1. **페이지네이션 기능 검증**:
   - 메시지 목록, Redis 로그, Kafka 로그에서 "더 보기" 버튼 정상 동작 확인
   - 페이지네이션 정보(현재 개수, 전체 개수) 정확성 확인

2. **유저별 데이터 격리 검증**:
   - 유저 A 로그인 → 데이터 확인 → 로그아웃 → 유저 B 로그인 → A의 데이터가 보이지 않는지 확인
   - 각 유저별로 올바른 데이터만 표시되는지 확인

3. **데이터 동기화 검증**:
   - 새 메시지 저장 후 즉시 목록에 반영되는지 확인
   - 로그인/로그아웃 시 데이터 초기화 및 새로고침 정상 동작 확인

4. **성능 및 사용자 경험 검증**:
   - 페이지네이션으로 인한 초기 로딩 속도 향상 확인
   - 밀리초까지 정확한 시간 표시 확인
   - 일관된 UI/UX 제공 확인
